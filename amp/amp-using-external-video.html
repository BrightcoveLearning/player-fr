---
title: AMP utilisant une vidéo externe
parent: amp
description: In this topic, you will learn how Accelerated Mobile Pages (AMP) can be used with Brightcove Player and an external, non-Video Cloud video.
---

<article class="bcls-article">
    <h1>AMP à l'aide d'une vidéo externe</h1>
    <summary>{{ page.description }}</summary>
    <section class="bcls-section">
        <aside class="bcls-aside bcls-aside--warning">Ce document utilise AMP avec Brightcove Player et une vidéo NON ingérée dans Video Cloud. Si vous êtes un client Video Cloud, consultez <a href="/playback/amp-using-video-cloud-video.html">AMP utilisant une vidéo Video Cloud</a>.</aside>
        <h2 id="Overview">Présentation</h2>
        <p>Accelerated Mobile Pages est un projet Google qui vise à permettre « la création de sites Web et d'annonces toujours rapides, beaux et performants sur tous les appareils et plateformes de distribution ». Vous pouvez utiliser Brightcove Player avec AMP car le projet comprend un <code translate="No">amp-brightcove</code> composant qui permet aux éditeurs d'intégrer Brightcove Players dans des documents HTML AMP. Cet exemple utilise un plugin personnalisé qui accepte une URL vers une vidéo externe (non-cloud vidéo) qui lui est transmise via le <code translate="No">amp-brightcove</code> composant utilisant la coutume <code translate="No">data-param-video-url</code> attribut.</p>
    </section>
    <section class="bcls-section">
        <h2 id="Sample">échantillon</h2>
        <p>Voici un exemple de page HTML AMP qui inclut un lecteur Brightcove Player. Le lecteur fonctionne normalement, donc le code HTML est la partie intéressante de cet exemple. Le code HTML est examiné plus loin dans ce document.</p>
        <p data-height="416" data-theme-id="dark" data-slug-hash="XZGQza" data-default-tab="html,result" data-user="rcrooks1969" data-embed-version="2" data-pen-title="AMP-Brightcove Player-External Video" class="codepen">Voir le stylo <a href="https://codepen.io/team/rcrooks1969/pen/XZGQza/">AMP-Brightcove Player-Vidéo externe</a> par Brightcove Learning Services (<a href="https://codepen.io/rcrooks1969"> rcrooks1969</a> ) sur <a href="https://codepen.io">CodePen</a>.</p>
        <script async src="https://static.codepen.io/assets/embed/ei.js"></script>
        <aside class="bcls-aside bcls-aside--warning">Notez qu'en raison du fonctionnement de l'AMP, vous devez examiner attentivement ses limites avant utilisation. Par exemple :
            <ul>
                <li>AMP a des règles très strictes sur ce que HTML peut et ne peut pas être utilisé sur une page. Les détails à ce sujet peuvent être consultés dans la spécification <a href="https://www.ampproject.org/docs/reference/spec">AMP HTML</a>.</li>
                <li>Brightcove Analytics ne signalera pas correctement la page de référence pour les pages AMP - à la place le <code translate="No">referrer_domain</code> sera vide, et <code translate="No">source_type</code> sera enregistré comme <code translate="No">direct</code>.</li>
                <li>Tous les attributs utilisés avec l'implémentation de page avancée de Brightcove Player ne sont pas valides avec <code translate="No">amp-brightcove</code>.</li>
                <li>AMP ne fonctionnera pas avec les joueurs restreints de domaine.</li>
            </ul>
        </aside>
    </section>
    <section class="bcls-section">
        <h2 id="Resources_from_AMP">Ressources d'AMP</h2>
        <p>Le projet AMP a développé un <code translate="No">amp-brightcove</code> composant spécial qui affiche le lecteur Brightcove. Le composant est détaillé dans le document <a href="https://www.ampproject.org/docs/reference/components/amp-brightcove">amp-brightcove.</a></p>
        <p>AMP fournit un exemple d' <code translate="No">amp-brightcove</code> implémentation avec des détails dans les documents suivants :</p>
        <ul>
            <li>amp-brightcove<a href="https://ampbyexample.com/components/amp-brightcove/"></a></li>
            <li><a href="https://github.com/ampproject/amp-by-example/blob/master/src/20_Components/amp-brightcove.html">amp-par exemple</a></li>
            <li><a href="https://ampbyexample.com/playground/#url=https%3A%2F%2Fampbyexample.com%2Fcomponents%2Famp-brightcove%2Fsource%2F">Aire de jeux AMP</a></li>
        </ul>
    </section>
    <section class="bcls-section">
        <h2 id="Player_configuration">Configuration du lecteur</h2>
        <p>Brightcove fournit un plugin pour améliorer l'utilisation d'AMP avec Brightcove Player. Le plugin ajoute la prise en charge de l'API d'interface vidéo d'AMP qui active certaines fonctionnalités avancées:</p>
        <ul>
            <li><strong>Intégration avec amp-analytics</strong>: Permet le suivi des vues vers des analyses tierces par rapport au domaine de la page AMP.</li>
            <li><strong>Intégration avec amp-bind</strong>: La lecture peut être contrôlée par d'autres éléments de la page AMP.</li>
        </ul>
        <p>Les joueurs sans plugin fonctionnent toujours dans AMP, mais sans cette fonctionnalité.</p>
        <h3><strong>Installation du plug-in</strong></h3>
        <aside class="bcls-aside bcls-aside--warning">Vous DEVEZ installer le plugin. Dans le passé, AMP fonctionnerait sans ajouter le plugin. Ce n'est plus vrai.</aside>
        <p>Comme pour tous les plugins Brightcove Player, vous avez besoin du nom et de l'URL du plugin vers le JavaScript du plugin, qui sont fournis ici (aucun fichier CSS n'est nécessaire pour l'utilisation de ce plugin) :</p>
        <h4>Nom du plugin</h4>
        <pre class="line-numbers">
  <code class="language-html" translate="No">ampSupport</code></pre>
        <h4>URL JavaScript</h4>
        <pre class="line-numbers">
  <code class="language-html" translate="No">//players.brightcove.net/videojs-amp-support/1/videojs-amp-support.js</code></pre>
    </section>
    <section class="bcls-section">
        <h2 id="HTML_page_code_examination">Examen du code de la page HTML</h2>
        <p>Le code de page HTML de l'exemple CodePen ci-dessus est indiqué ci-dessous (le code du plugin est détaillé dans la section suivante). Une explication complète du code est fournie par AMP dans les documents mentionnés ci-dessus. Dans la liste suivante, vous trouverez quelques astuces/pièges à prendre en compte :</p>
        <ul>
            <li>Ligne 14 : Vous pouvez ajouter une seule <code translate="No">style</code> balise, mais elle doit inclure l' <code translate="No">amp-custom</code> attribut.</li>
            <li>Ligne 26: NE PAS embellir le code. La plaque de cuisson CSS est nécessaire tel que fourni par AMP.</li>
            <li>Ligne 42 : L'URL de la vidéo externe est transmise ici. N'oubliez pas que puisque le nom sera récupéré à partir d'une iframe <code translate="No">src</code> URL, le nom sera <code translate="No">videoUrl</code>.</li>
            <li>Ligne 43 : le <code translate="No">data-video-id</code> doit être présent, mais aucune valeur ne lui est attribuée lors de l'utilisation d'une vidéo externe.</li>
            <li>Ligne 44 : Les <code translate="No">width</code> et <code translate="No">height</code> les attributs déterminent le rapport hauteur/largeur du lecteur intégré dans les mises en page réactives.</li>
        </ul>
        <pre class="line-numbers" data-start="1">
  <code class="language-html" translate="No">&lt;!--
    ## Introduction
  
    The `amp-brightcove` component allows embedding a Brightcove
    [Video Cloud](https://www.brightcove.com/en/online-video-platform) or
    [Perform](https://www.brightcove.com/en/perform) player.
  --&gt;
  &lt;!-- --&gt;
  &lt;!doctype html&gt;
  &lt;html ⚡&gt;
  &lt;head&gt;
    &lt;meta charset="utf-8"&gt;
    &lt;title&gt;amp-brightcove&lt;/title&gt;
    &lt;style amp-custom&gt;
      .player-container {
        width: 640px;
        height: 360px;
      }
    &lt;/style&gt;
    &lt;script async src="https://cdn.ampproject.org/v0.js"&gt;&lt;/script&gt;
    &lt;!-- ## Setup --&gt;
    &lt;!-- Import the Brightcove component in the header. --&gt;
    &lt;script async custom-element="amp-brightcove" src="https://cdn.ampproject.org/v0/amp-brightcove-0.1.js"&gt;&lt;/script&gt;
    &lt;meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"&gt;
    &lt;link rel="canonical" href="https://ampbyexample.com/components/amp-brightcove/"&gt;
    &lt;style amp-boilerplate&gt;body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}&lt;/style&gt;&lt;noscript&gt;&lt;style amp-boilerplate&gt;body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}&lt;/style&gt;&lt;/noscript&gt;
  
  
  &lt;/head&gt;
  &lt;body&gt;
  
    &lt;!-- ## Basic Usage --&gt;
    &lt;!--
      A responsive brightcove video. The required data is `data-account` and `data-video-id`. Other
      supported parameters are `data-player-id`, `data-embed` and `data-playlist-id`.
    --&gt;
    &lt;div class="player-container"&gt;
      &lt;amp-brightcove
        data-account="3676484087001"
        data-player-id="ByrhJWAPf"
        layout="responsive"
        data-param-video-url="//solutions.brightcove.com/bcls/videos/calm-day-oregon-coast.mp4"
        data-video-id
        width="16" height="9"&gt;
      &lt;/amp-brightcove&gt;
    &lt;/div&gt;
  
  
  &lt;/body&gt;
  &lt;/html&gt;</code></pre>
    </section>
    <section class="bcls-section">
        <h2 id="Plugin_code_examination">Examen du code du plugin</h2>
        <p>Le fonctionnement de l'AMP est que le <code translate="No">amp-brightcove</code> crée une implémentation iframe du Brightcove Player. Dans l'URL de l'iframe sera l'attribut personnalisé, comme indiqué ici:</p>
        <pre class="line-numbers">
  <code class="language-html" translate="No">&lt;iframe frameborder="0" allowfullscreen="true" src="https://players.brightcove.net/3676484087001/ByrhJWAPf_default/index.html?<span class="bcls-highlight">videoUrl=%2F%2Fsolutions.brightcove.com%2Fbcls%2Fvideos%2Fcalm-day-oregon-coast.mp4"</span>; class="i-amphtml-fill-content" kwframeid="1"&gt;&lt;/iframe&gt;</code></pre>
        <p>Si vous faites défiler le code iframe, vous verrez la chaîne de requête affichée ici:</p>
        <figure class="bcls-figure"><img class="bcls-image" alt="AMP iframe source" src="/assets/images/amp/amp-external-amp-url.png" /></figure>
        <p>Notez que le nom de la chaîne de requête est <code translate="No">videoUrl</code>. Notez également que l'URL a été encodée en URL. Ces deux problèmes seront reflétés dans le code du plugin, montré ici:</p>
        <ul>
            <li>Lignes 21-38: Une fonction d'assistance qui trouve la valeur associée à une chaîne de requête, transmise à la fonction en tant que paramètre.</li>
            <li>Ligne 7 : Récupérez la valeur du <code translate="No">videoUrl</code> chaîne de requête utilisant la fonction d'assistance.</li>
            <li>Ligne 8 : Utilisez JavaScript <code translate="No">decodeURIComponent()</code> méthode pour obtenir une URL valide pour la vidéo.</li>
            <li>Lignes 11-14: Utilisez l'URL décodée et placez la vidéo dans le lecteur. Si vous envisagez d'utiliser des formats de vidéo autres que MP4, vous devrez soit passer le bon <code translate="No">type</code> value, ou écrivez une logique pour lire l'extension de la vidéo et attribuer la valeur correcte.</li>
            <li>Lignes 17 à 19 : Bien sûr, pas obligatoire, mais si vous voulez que la vidéo soit lue au démarrage, vous pouvez utiliser ce code.</li>
        </ul>
        <pre class="line-numbers">
  <code class="language-javascript" translate="No">videojs.registerPlugin('ampPassVideo', function() {
    var myPlayer = this,
      encodedVideoQueryParam,
      decodedVideoQueryParam;
  
    // Get the query string and un-URL encode it
    encodedVideoQueryParam = getQuerystring('videoUrl');
    decodedVideoQueryParam = decodeURIComponent(encodedVideoQueryParam);
  
    // Load the video into the player
    myPlayer.src({
      'type': 'video/mp4',
      'src': decodedVideoQueryParam
    });
  
    // On loadedmetadata event, play the video
    myPlayer.on('loadedmetadata', function(){
      myPlayer.play();
    });
  
    /*
     * usage: foo = getQuerystring("bctid", null);
     * foo will be equal to value of query param bctid
     * note that the default_ parameter is what you will get back
     * if the key isn’t found
     */
    function getQuerystring(key, default_) {
      var regex, qs;
      if (default_ == null) default_ = "";
      key = key.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
      regex = new RegExp("[\\?&amp;]" + key + "=([^&amp;#]*)");
      qs = regex.exec(window.location.href);
      if (qs === null) {
        return default_;
      } else {
        return qs[1];
      }
    }
  });</code></pre>
        <p>Vous attribueriez ce plugin à votre lecteur soit en utilisant <a href="https://studio.support.brightcove.com/players/configuring-player-plugins.html">Studio</a> ou l'API de gestion des joueurs.</p>
    </section>
    <section class="bcls-section">
        <h2 id="Features">Fonctionnalités</h2>
        <p>Bien que discutées dans la documentation sur les SAP, quelques caractéristiques sont soulignées ici qui revêtent une importance particulière :</p>
        <!-- These are features that are common to both Video Cloud and external videos -->
        <!-- THIS SECTION CAN BE ADDED TO THEN COPIED TO SIMILAR SECTION IN Video Cloud VIDEO FEATURES SECTION -->

        <h3>Paramètres personnalisés</h3>
        <p>Vous voudrez peut-être transmettre des informations supplémentaires à votre lecteur pour que vos plugins puissent y accéder. Pour ce faire, ajoutez des attributs supplémentaires à l' <code translate="No">amp-brightcove</code> élément qui doit être nommé <code translate="No">data-param-*</code>, où <code translate="No">*</code> est le nom de votre propriété.</p>
        <p>Les paramètres sont transmis sous forme de noms d'attributs camel ajoutés à l'URL du lecteur. Les clés et les valeurs sont encodées en URL. Par exemple :</p>
        <ul>
            <li><code translate="No">data-param-language="de"</code> devient <code translate="No">&amp;language=de</code></li>
            <li><code translate="No">data-param-ad-vars="key:val;key2:val2"</code> devient <code translate="No">&amp;adVars=key%3Aval%3Bkey2%3Aval2</code></li>
        </ul>
        <h3>Prise en charge des référents externes</h3>
        <p>Brightcove Player v6.25.0+ prend en charge la définition d'un référent arbitraire sur un iframe. Le composant AMP prend désormais en charge le passage de son propre référent au lecteur, en ajoutant un <code translate="No">referrer="EXTERNAL_REFERRER"</code> attribut à son intégration amp-brightcove.</p>
        <p>EXTERNAL_REFERRER est la macro d'AMP. Voir <a href="https://github.com/ampproject/amphtml/blob/19135a3aac7813a9ff263a9f863fe35aeb316582/spec/amp-var-substitutions.md#external-referrer">https://github.com/ampproject/amphtml/blob/19135a3aac7813a9ff263a9f863fe35aeb316582/spec/amp-var-substitutions.md#external-referrer</a> pour plus d'informations.</p>
        <h3>Analytique AMP</h3>
        <p>Un composant <strong>amp-analytics</strong> peut être utilisé dans un document AMP pour effectuer le suivi des données vers n'importe quelle analyse arbitraire. Si les éditeurs souhaitent inclure des événements vidéo, ils peuvent désormais le faire.</p>
        <p>Le document d'AMP sur la syntaxe AMP Analytics (qui est encombrant) est ici : <a href="https://www.ampproject.org/docs/reference/components/amp-analytics">https://www.ampproject.org/docs/reference/components/amp-analytics</a>. Et plus précisément l'analyse vidéo : <a href="https://github.com/ampproject/amphtml/blob/master/extensions/amp-analytics/amp-video-analytics.md">https://github.com/ampproject/amphtml/blob/master/extensions/amp-analytics/amp-video-analytics.md</a>.</p>
        <p>Un exemple est disponible, suivi vers <strong>exemple.com</strong> afin que vous verrez les balises sous forme d'erreurs dans l'onglet réseau : <a href="http://solutions.brightcove.com/bclifford/ampexamples/analytics.html">http://solutions.brightcove.com/bclifford/ampexamples/analytics.html</a>.</p>
        <h3>Liaison AMP</h3>
        <p>AMP Bind est l'API d'AMP pour interagir entre les composants. Au niveau de base, il vous permet d'avoir quelque chose d'extérieur au lecteur pour contrôler la lecture. Par exemple, le code suivant lirait une vidéo, où <code translate="No">myPlayer</code> se trouve le <code translate="No">id</code> lecteur amp-brightcove.</p>
        <pre class="line-numbers">
    <code class="language-html" translate="No">&lt;button on="tap:myPlayer.play"&gt;Play&lt;/button&gt;</code></pre>
        <p>AMP ne fait pas confiance aux événements vidéo, donc vous ne pouvez pas faire quelque chose de plus utile, comme agir sur une extrémité vidéo. Un exemple de ceci est disponible ici : <a href="http://solutions.brightcove.com/bclifford/ampexamples/bind.html">http://solutions.brightcove.com/bclifford/ampexamples/bind.html</a>.</p>
    </section>
</article>