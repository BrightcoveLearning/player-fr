---
title: 'Exemple de lecteur Brightcove : Désactiver le nettoyage avant'
description: 'Dans cette rubrique, vous apprendrez à utiliser une fonction middleware pour désactiver le nettoyage avant jusqu'à ce qu'un pourcentage spécifié de la vidéo ait été lu.'
parent: Code Samples
---
 <h1>{{ page.title }}</h1>
<article class="bcls-article">
  <summary>{{ page.description }}</summary>

  <section class="bcls-section">
    <h2 id="Player_example">Exemple de lecteur</h2>
    <!-- UPDATE description -->
    
    <aside class="bcls-aside bcls-aside--information">Cet exemple et le code associé sont fournis comme guide pour le développement de votre production. Le code n'est pas certifié pour une utilisation en production ni officiellement pris en charge.</aside>
    <p>Au départ, vous ne pourrez PAS frotter vers l'avant, mais il est possible de frotter vers l'arrière. Une fois que la vidéo atteint 50% de lecture, vous pouvez faire défiler vers l'avant ou vers l'arrière. Le pourcentage de quand autoriser le brossage vers l'avant est facilement défini dans le code.</p>
    <!-- UPDATE codepen here -->
    
    <p data-height="452" data-theme-id="34967" data-slug-hash="OvzyMN" data-default-tab="result" data-user="rcrooks1969" data-embed-version="2" data-pen-title="Disable Forward Scrubbing" class="codepen">Voir le stylo <a href="https://codepen.io/team/rcrooks1969/pen/OvzyMN/">Désactiver le défilement avant</a> par Brightcove Learning Services (<a href="https://codepen.io/rcrooks1969"> rcrooks1969</a> ) sur <a href="https://codepen.io">CodePen</a>.</p>
    <script async src="https://static.codepen.io/assets/embed/ei.js"></script><!-- UPDATE link to GitHub source -->
    
    <h3>Code source</h3>
          <p>Voir le <a href="https://github.com/BrightcoveLearning/18571-disable-forward-scrubbing">solution complète sur GitHub</a>.</p>
  </section>
  <section class="bcls-section">
    <details>
      <summary><h2 id="Using_the_CodePen">Utilisation du CodePen</h2></summary>
      <p>Voici quelques conseils pour utiliser efficacement le CodePen ci-dessus :</p>
      <ul>
        <li>Basculez l'affichage réel du lecteur en cliquant sur le bouton <strong translate="No">Résultat</strong> bouton.</li>
        <li>Clique le <strong translate="No">HTML/CSS/JS</strong> pour afficher UN des types de code.</li>
        <li>Plus loin dans ce document, la logique, le flux et le style utilisés dans l'application seront discutés dans la configuration <a href="#Player/HTML_configuration">Plateur/HTML</a>, le flux <a href="#Application_flow">d'application</a> et le style de <a href="#Application_styling">l'application.</a> sections. La meilleure façon de suivre les informations contenues dans ces sections est de :
          <ol>
            <li>Clique le <strong translate="No">MODIFIER SUR CODEPEN</strong> dans le CodePen et avoir le code disponible dans un navigateur/onglet de navigateur.</li>
            <li>Dans CodePen, réglez le code que vous souhaitez afficher. Vous pouvez modifier la largeur de différentes sections de code dans CodePen.</li>
            <li>Voir le <a href="#Player/HTML_configuration">Configuration du lecteur/HTML</a> , <a href="#Application_flow">Flux de candidature</a> et/ou <a href="#Application_styling">Style d'application</a> sections dans un autre navigateur/onglet de navigateur. Vous serez maintenant en mesure de suivre les explications du code et en même temps voir le code.</li>
          </ol>
        </li>
      </ul>
    </details>
  </section>
  
  <section class="bcls-section">
    <h2 id="Middleware_functions">Fonctions Middleware</h2>
    <p>Cet exemple utilise le middleware Video.js pour implémenter la solution de code. À un niveau très élevé, les cas d'utilisation où le middleware est de la plus grande valeur est lorsque vous voulez intercepter et modifier les comportements de base du joueur, tels que la définition de la source ou de l'heure actuelle. Le middleware Video.js en général n'est pas discuté longuement dans ce document, mais le code utilisé pour la fonction intergiciel est expliqué. Voici des documents provenant de sources Video.js qui détaillent les intergiciels :</p>
    <ul>
      <li><a href="http://docs.videojs.com/tutorial-middleware.html">Middleware (à partir du jeu de documentation Video.js)</a></li>
      <li><a href="http://blog.videojs.com/feature-spotlight-middleware/">Pleins feux sur les fonctionnalités : Middleware (extrait du blog Video.js)</a></li>
      <li><a href="https://github.com/videojs/videojs-playbackrate-adjuster">videojs-playbackrate-adjuster (exemple d'application)</a></li>
    </ul>
    <h3>Implémentation de fonctions d'intergiciel avec Brightcove Player</h3>
    <p>Le moyen le plus simple d'utiliser une fonction intergiciel consiste à :</p>
    <ol>
      <li>Écrivez la fonction intergiciel.</li>
      <li>Placez la fonction intergiciel soit sur la page avec le lecteur dans une <code translate="No">script</code> balise, soit inclure la fonction intergiciel à l'aide de l' <code translate="No">src</code> attribut avec un <code translate="No">script</code> étiquette. Les deux implémentations seront présentées dans ce document.</li>
      <li>Enregistrez la fonction intergiciel auprès du lecteur à l'aide de la <code translate="No">use()</code> méthode, comme indiqué ici :
        <pre class="line-numbers">
<code class="language-javascript" translate="No">videojs.use('mimeType', functionName);</code></pre>
        <p>Pour le <strong>type MIME,</strong> vous pouvez utiliser un type MIME vidéo standard, comme <strong>vidéo/mp4</strong>, ou utiliser un <strong>*</strong> si vous souhaitez que la fonction intergiciel agisse sur tous les mimétypes.</p>
      </li>
    </ol>
  </section>
  <!-- UPDATE player and HTML configuration -->
  
  <section class="bcls-section">
    <h2 id="Player/HTML_configuration">Configuration du lecteur/HTML</h2>
    <p>Cette section détaille toute configuration spéciale nécessaire lors de la création du lecteur. En outre, d'autres éléments HTML qui doivent être ajoutés à la page, au-delà du code d'implémentation du lecteur intégré dans la page, sont décrits.</p>
    <h3>Configuration du joueur</h3>
    <p>Aucune configuration spéciale n'est requise pour le lecteur Brightcove que vous créez pour cet exemple.</p>
    <h3>Autres HTML</h3>
    <p>Aucun autre élément HTML n'est ajouté à la page.</p>
  </section>
  <!-- UPDATE application flow -->
  
  <section class="bcls-section">
    <h2 id="Application_flow">Flux d'application</h2>
    <p>La logique de base derrière cette application est :</p>
    <ul>
      <li>Implémentez la syntaxe de base d'une fonction middleware, en nommant la fonction <code translate="No">disableForwardScrubbing</code>.</li>
      <li>Mettre en œuvre les <code translate="No">setSource()</code> méthode.</li>
      <li>Modifier le <code translate="No">setCurrentTime()</code> pour vérifier si l'heure à laquelle le spectateur essaie de nettoyer est inférieure à l'heure actuelle dans le lecteur ou si le pourcentage de défilement avant est passé. Si l'un ou l'autre est vrai, déplacez la tête de lecture sur cette heure. Si faux, continuez à lire la vidéo à l'heure actuelle.</li>
    </ul>
    <!-- UPDATE task 1 -->
    
    <h3>Créer le squelette de la fonction intergiciel</h3>
    <p>Trouvez le code qui est étiqueté :</p>
    <pre>
<code class="language-javascript" translate="No">// +++ Define the middleware function+++</code></pre>
    <p>La syntaxe de base pour créer une fonction d'intergiciel est la suivante :</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">var disableForwardScrubbing = function(player) {
  return {
  ...
};</code></pre>
    <p>Notez que l' <code translate="No">player</code> objet est transmis à la fonction.</p>
    <!-- UPDATE task 2 -->
    
    <h3>Mettre en œuvre le <code translate="No">setSource()</code> méthode</h3>
    <p>Trouvez le code qui est étiqueté :</p>
    <pre>
<code class="language-javascript" translate="No">// ### Implement setSource() ###</code></pre>
    <p>Il s'agit d'une méthode obligatoire pour chaque fonction de middleware. En utilisant la syntaxe affichée signifie que le middleware sera toujours sélectionné, quel que soit le type de vidéo :</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">setSource: function setSource(srcObj, next) {
  next(null, srcObj);
},</code></pre>
    <!-- UPDATE task 3 -->
    
    <h3>Modifier la méthode setCurrentTime ()</h3>
    <p>Trouvez le code qui est étiqueté :</p>
    <pre>
<code class="language-javascript" translate="No">// ### Alter the setCurrentTime method ###</code></pre>
    <p>Ce bloc de code est l'endroit où le réel <code translate="No">setCurrentTime()</code> la méthode est modifiée. Pour comprendre cela, le premier point à savoir est que le <code translate="No">ct</code> La valeur transmise à la fonction reflète la valeur à laquelle le spectateur effectue le balayage. le <code translate="No">if</code> La déclaration vérifie si la nouvelle valeur est inférieure à l'heure actuelle du joueur ou dépasse le pourcentage pour permettre le balayage vers l'avant. Si l'un ou l'autre est vrai, la nouvelle valeur est renvoyée, ce qui entraîne le déplacement de la tête de lecture vers la nouvelle valeur. Si la condition est fausse, ce qui signifie que le spectateur essaie d'avancer avant d'être autorisé, l'heure actuelle du lecteur est renvoyée et la lecture n'est pas modifiée.</p>
    <pre class="line-numbers">
<code class="language-javascript" translate="No">setCurrentTime: function setCurrentTime(ct) {
  var percentAllowForward = 50,
   // Determine percentage of video played
   percentPlayed = player.currentTime() / player.duration() * 100;
   // Check if the time scrubbed to is less than the current time
   // or if passed scrub forward percentage
  if ( ct &lt; player.currentTime() || percentPlayed &gt; percentAllowForward ) {
    // If true, move playhead to desired time
    return ct;
  }
  // If time scrubbed to is past current time and not passed percentage
  // leave playhead at current time
  return player.currentTime();
}</code></pre>
  </section>
  <!-- UPDATE CSS description -->
  
  <section class="bcls-section">
    <h2 id="Application_styling">Style d'application</h2>
    <p>Le CSS de la page définit simplement la taille du lecteur.</p>
  </section>
  <section class="bcls-section">
    <h2 id="Using_the_middleware_function">Utilisation de la fonction intergiciel</h2>
    <p>Une fois que la fonction intergiciel a été écrite, vous souhaitez l'utiliser. Deux façons ont été mentionnées plus tôt, et elles seront détaillées maintenant.</p>
    <h3>Code sur la même page que le joueur</h3>
    <p>Ici, vous définissez la fonction intergiciel sur la même page que le lecteur, puis vous l'enregistrez.</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="5701202551001"
  data-account="1752604059001"
  data-player="default"
  data-embed="default"
  data-application-id
  class="video-js"
  controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

<span class="bcls-highlight">&lt;script type="text/javascript"&gt;
  // +++ Define the middleware function+++
  var disableForwardScrubbing = function(player) {
    return {
      // +++ Implement setSource() +++
      setSource: function setSource(srcObj, next) {
        next(null, srcObj);
      },
      // +++ Alter the setCurrentTime method +++
      setCurrentTime: function setCurrentTime(ct) {
        var percentAllowForward = 50,
         // Determine percentage of video played
         percentPlayed = player.currentTime() / player.duration() * 100;
         // Check if the time scrubbed to is less than the current time
         // or if passed scrub forward percentage
        if ( ct &lt; player.currentTime() || percentPlayed &gt; percentAllowForward ) {
          // If true, move playhead to desired time
          return ct;
        }
        // If time scrubbed to is past current time and not passed percentage
        // leave playhead at current time
        return player.currentTime();
      }
    }
  };

  // Register the middleware with the player
  videojs.use('*', disableForwardScrubbing);</span>

&lt;/script&gt;</code></pre>
    <h3>Code inclus sur la page du joueur</h3>
    <p>Dans le code suivant, le JavaScript de la fonction middleware et le <code translate="No">use()</code> méthode pour l'enregistrer sont simplement inclus dans la page.</p>
    <pre class="line-numbers">
<code class="language-html" translate="No">&lt;video-js id="myPlayerID"
  data-video-id="5701202551001"
  data-account="1752604059001"
  data-player="default"
  data-embed="default"
  data-application-id
  class="video-js"
  controls&gt;&lt;/video-js&gt;
&lt;script src="https://players.brightcove.net/1752604059001/default_default/index.min.js"&gt;&lt;/script&gt;

<span class="bcls-highlight">&lt;script src="disable-forward-scrubbing.js"&gt;&lt;/script&gt;</span></code></pre>
    <p>Voir le <a href="https://github.com/BrightcoveLearning/18571-disable-forward-scrubbing/tree/master/function-in-separate-file">fonction dans un fichier séparé</a> section dans le dépôt GitHub pour le code complet.</p>
  </section>
</article>